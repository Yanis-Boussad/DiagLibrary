/**
 * This file was generated by the Objective Systems ASN1C Compiler
 * (http://www.obj-sys.com).  Version: 6.6.2-pre4, Date: 04-Apr-2013.
 */
#include "TS24007L3.h"
#include "rtxsrc/rtxCommon.h"
#include "rtxsrc/rtxBitDecode.h"
#include "rtxsrc/rtxIntDecode.h"
#include "rtxsrc/rtx3GPP.h"
#include "rtxsrc/rtxDiagBitTrace.h"

EXTERN int NASDec_TS24007L3_EPSBearerIdentity (OSCTXT* pctxt
   , TS24007L3_EPSBearerIdentity* pvalue)
{
   int ret = 0;

   RTXCTXTPUSHTYPENAME (pctxt, "EPSBearerIdentity");

   /* Decode ENUMERATED value */
   RTDIAG_NEWBITFIELD (pctxt, "ENUMERATED");

   {
      OSUINT8 tmpval;
      ret = rtxDecBitsToByte (pctxt, &tmpval, 4);
      if (ret < 0) return LOG_RTERR (pctxt, ret);
      *pvalue = tmpval;
   }

   RTDIAG_SETBITFLDCOUNT (pctxt);
   switch (*pvalue) {
      case TS24007L3_EPSBearerIdentity_noIdent:
      case TS24007L3_EPSBearerIdentity_id5:
      case TS24007L3_EPSBearerIdentity_id6:
      case TS24007L3_EPSBearerIdentity_id7:
      case TS24007L3_EPSBearerIdentity_id8:
      case TS24007L3_EPSBearerIdentity_id9:
      case TS24007L3_EPSBearerIdentity_id10:
      case TS24007L3_EPSBearerIdentity_id11:
      case TS24007L3_EPSBearerIdentity_id12:
      case TS24007L3_EPSBearerIdentity_id13:
      case TS24007L3_EPSBearerIdentity_id14:
      case TS24007L3_EPSBearerIdentity_id15:
         break;

      default:
         rtxErrAddUIntParm (pctxt, *pvalue);
         return LOG_RTERR (pctxt, RTERR_INVENUM);
   }

   RTXCTXTPOPTYPENAME (pctxt);

   return (ret);
}

EXTERN int NASDec_TS24007L3_ProtoDiscr (OSCTXT* pctxt
   , TS24007L3_ProtoDiscr* pvalue)
{
   int ret = 0;

   RTXCTXTPUSHTYPENAME (pctxt, "ProtoDiscr");

   /* Decode ENUMERATED value */
   RTDIAG_NEWBITFIELD (pctxt, "ENUMERATED");

   {
      OSUINT8 tmpval;
      ret = rtxDecBitsToByte (pctxt, &tmpval, 4);
      if (ret < 0) return LOG_RTERR (pctxt, ret);
      *pvalue = tmpval;
   }

   RTDIAG_SETBITFLDCOUNT (pctxt);
   if (*pvalue >= 12) {
      rtxErrAddUIntParm (pctxt, *pvalue);
      return LOG_RTERR (pctxt, RTERR_INVENUM);
   }

   RTXCTXTPOPTYPENAME (pctxt);

   return (ret);
}

EXTERN int NASDec_TS24007L3_SecHdrType (OSCTXT* pctxt
   , TS24007L3_SecHdrType* pvalue)
{
   int ret = 0;

   RTXCTXTPUSHTYPENAME (pctxt, "SecHdrType");

   /* Decode ENUMERATED value */
   RTDIAG_NEWBITFIELD (pctxt, "ENUMERATED");

   {
      OSUINT8 tmpval;
      ret = rtxDecBitsToByte (pctxt, &tmpval, 4);
      if (ret < 0) return LOG_RTERR (pctxt, ret);
      *pvalue = tmpval;
   }

   RTDIAG_SETBITFLDCOUNT (pctxt);
   switch (*pvalue) {
      case TS24007L3_SecHdrType_noSec:
      case TS24007L3_SecHdrType_integProt:
      case TS24007L3_SecHdrType_integProtAndCipher:
      case TS24007L3_SecHdrType_integProtAndSecCtxt:
      case TS24007L3_SecHdrType_integProtAndCipherAndSecCtxt:
      case TS24007L3_SecHdrType_secHdrForSvcReq:
         break;

      default:
         rtxErrAddUIntParm (pctxt, *pvalue);
         return LOG_RTERR (pctxt, RTERR_INVENUM);
   }

   RTXCTXTPOPTYPENAME (pctxt);

   return (ret);
}

/* begin custom source file NASDec_TS24007L3_L3HdrOptions.c */

EXTERN int NASDec_TS24007L3_L3HdrOptions (OSCTXT* pctxt
   , TS24007L3_L3HdrOptions* pvalue)
{
   int ret = 0;

   RTXCTXTPUSHTYPENAME (pctxt, "L3HdrOptions");

   /* Only skip indicator is decoded at this time.  The t value will be 
      set later after protocol discriminator is decoded. */

   RTXCTXTPUSHELEMNAME (pctxt, "skipInd");

   RTDIAG_NEWBITFIELD (pctxt, "INTEGER");

   pvalue->t = 1;

   ret = rtxDecBitsToByte (pctxt, &pvalue->u.skipInd, 4);
   if (ret < 0) return LOG_RTERR (pctxt, ret);

   RTDIAG_SETBITFLDCOUNT (pctxt);

   RTXCTXTPOPELEMNAME (pctxt);

   RTXCTXTPOPTYPENAME (pctxt);

   return (ret);
}

/* end custom source file NASDec_TS24007L3_L3HdrOptions.c */

EXTERN int NASDec_TS24007L3_Header (OSCTXT* pctxt, TS24007L3_Header* pvalue)
{
   int ret = 0;

   RTXCTXTPUSHTYPENAME (pctxt, "Header");

   /* decode l3HdrOpts */

   RTXCTXTPUSHELEMNAME (pctxt, "l3HdrOpts");

   ret = NASDec_TS24007L3_L3HdrOptions (pctxt, &pvalue->l3HdrOpts);
   if (ret < 0) return LOG_RTERR (pctxt, ret);

   RTXCTXTPOPELEMNAME (pctxt);

   /* decode protoDiscr */

   RTXCTXTPUSHELEMNAME (pctxt, "protoDiscr");

   ret = NASDec_TS24007L3_ProtoDiscr (pctxt, &pvalue->protoDiscr);
   if (ret < 0) return LOG_RTERR (pctxt, ret);

   RTXCTXTPOPELEMNAME (pctxt);

   /* decode msgType */

   RTXCTXTPUSHELEMNAME (pctxt, "msgType");

   RTDIAG_NEWBITFIELD (pctxt, "INTEGER");

   ret = rtxDecBitsToByte (pctxt, &pvalue->msgType, 8);
   if (ret < 0) return LOG_RTERR (pctxt, ret);

   RTDIAG_SETBITFLDCOUNT (pctxt);

   RTXCTXTPOPELEMNAME (pctxt);

   RTXCTXTPOPTYPENAME (pctxt);

   return (ret);
}

EXTERN int NASDec_TS24007L3_MsgType_MM_CC_SS (OSCTXT* pctxt
   , TS24007L3_MsgType_MM_CC_SS* pvalue)
{
   int ret = 0;

   RTXCTXTPUSHTYPENAME (pctxt, "MsgType_MM_CC_SS");

   /* decode sendSeqNum */

   RTXCTXTPUSHELEMNAME (pctxt, "sendSeqNum");

   RTDIAG_NEWBITFIELD (pctxt, "INTEGER");

   ret = rtxDecBitsToByte (pctxt, &pvalue->sendSeqNum, 2);
   if (ret < 0) return LOG_RTERR (pctxt, ret);

   RTDIAG_SETBITFLDCOUNT (pctxt);

   RTXCTXTPOPELEMNAME (pctxt);

   /* decode value */

   RTXCTXTPUSHELEMNAME (pctxt, "value");

   RTDIAG_NEWBITFIELD (pctxt, "INTEGER");

   ret = rtxDecBitsToByte (pctxt, &pvalue->value, 6);
   if (ret < 0) return LOG_RTERR (pctxt, ret);

   RTDIAG_SETBITFLDCOUNT (pctxt);

   RTXCTXTPOPELEMNAME (pctxt);

   RTXCTXTPOPTYPENAME (pctxt);

   return (ret);
}

EXTERN int NASDec_TS24007L3_SecProtMsgHeader (OSCTXT* pctxt
   , TS24007L3_SecProtMsgHeader* pvalue)
{
   int ret = 0;

   RTXCTXTPUSHTYPENAME (pctxt, "SecProtMsgHeader");

   /* decode secHdrType */

   RTXCTXTPUSHELEMNAME (pctxt, "secHdrType");

   ret = NASDec_TS24007L3_SecHdrType (pctxt, &pvalue->secHdrType);
   if (ret < 0) return LOG_RTERR (pctxt, ret);

   RTXCTXTPOPELEMNAME (pctxt);

   /* decode protoDiscr */

   RTXCTXTPUSHELEMNAME (pctxt, "protoDiscr");

   RTDIAG_NEWBITFIELD (pctxt, "INTEGER");

   ret = rtxDecBitsToByte (pctxt, &pvalue->protoDiscr, 4);
   if (ret < 0) return LOG_RTERR (pctxt, ret);

   RTDIAG_SETBITFLDCOUNT (pctxt);

   RTXCTXTPOPELEMNAME (pctxt);

   /* decode msgAuthCode */

   RTXCTXTPUSHELEMNAME (pctxt, "msgAuthCode");

   RTDIAG_NEWBITFIELD (pctxt, "INTEGER");

   ret = rtxDecUInt32 (pctxt, &pvalue->msgAuthCode, 4);
   if (ret < 0) return LOG_RTERR (pctxt, ret);

   RTDIAG_SETBITFLDCOUNT (pctxt);

   RTXCTXTPOPELEMNAME (pctxt);

   /* decode seqNumber */

   RTXCTXTPUSHELEMNAME (pctxt, "seqNumber");

   RTDIAG_NEWBITFIELD (pctxt, "INTEGER");

   ret = rtxDecBitsToByte (pctxt, &pvalue->seqNumber, 8);
   if (ret < 0) return LOG_RTERR (pctxt, ret);

   RTDIAG_SETBITFLDCOUNT (pctxt);

   RTXCTXTPOPELEMNAME (pctxt);

   RTXCTXTPOPTYPENAME (pctxt);

   return (ret);
}

